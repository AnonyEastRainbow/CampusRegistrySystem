LWR.define("@salesforce/label/MyCommunities.errorInFileDownload/v/0_9_0",["exports"],function(f){"use strict";var p="MyCommunities.errorInFileDownload";f.default=p,Object.defineProperty(f,"__esModule",{value:!0})}),LWR.define("mobileruntime/hybridAppManager/v/1",["exports","lwr/loaderLegacy/v/0_9_0","logger/v/1_66_319-244_0","webruntime/routingService/v/1_66_319-244_0","@salesforce/site/Id/v/1","webruntime/transport/v/1_66_319-244_0","lwc/v/2_41_4","@app/basePath/v/1","@app/loginPath/v/1","@app/uiBasePath/v/1","@salesforce/label/MyCommunities.errorInFileDownload/v/0_9_0","webruntime/overrides/v/1_66_319-244_0"],function(f,p,l,R,x,B,d,V,_,W,H,g){"use strict";function h(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var G=h(x),M=h(V),y=h(_),J=h(W),q=h(H);function K(){if(window.navigator?.userAgent?.includes("android")){const{head:e}=document,t=document.createElement("script");t.src="/localhost/cordova.js",e.appendChild(t)}}function Y(){window.native={sendAILTNData:function(e){if(!e?.logLines)return new Promise(function(t,n){n("Received null or invalid payload")})},refreshNotifications:function(){document.dispatchEvent(new CustomEvent("refreshNotifications",{detail:{},bubbles:!0,cancelable:!0,composed:!1}))},navigateTo:function(e){return new Promise(function(t,n){if(!e){n("Received invalid pageReference payload");return}R.generateUrl(e).then(o=>{window.open(new URL(o,window.location.href)),t()},o=>n(o))})}}}const z=d.parseFragment`<div class="slds-backdrop slds-backdrop_open${0}"${2}></div>`,Q={key:0},X={"slds-modal":!0,"slds-fade-in-open":!0,"slds-modal_large":!0},Z={classMap:{"slds-modal__container":!0},key:2},$={classMap:{"slds-modal__header":!0},key:3},ee={"slds-modal__title":!0,"slds-hyphenate":!0},te={"slds-modal__content":!0,"slds-var-p-around_medium":!0},ne={classMap:{"slds-text-align_center":!0,"slds-text-heading_small":!0,"slds-var-p-around_medium":!0},key:6},oe={classMap:{"slds-modal__footer":!0},key:7},E={"slds-button":!0,"slds-button_brand":!0},ie={key:9},ae={key:11};function w(e,t,n,o){const{gid:i,d:a,t:r,h:s,b:c,st:u}=e,{_m0:m,_m1:U}=o;return[t.showModal?s("section",Q,[s("section",{classMap:X,attrs:{role:"dialog",tabindex:"-1","aria-labelledby":i("modal-heading-01"),"aria-modal":"true","aria-describedby":i("modal-content-id-1")},key:1},[s("div",Z,[s("header",$,[s("h2",{classMap:ee,attrs:{id:i("modal-heading-01")},key:4},[r(a(t.labels.ModalHeader))])]),s("div",{classMap:te,attrs:{id:i("modal-content-id-1")},key:5},[s("div",ne,[r(a(t.modalBody))])]),s("footer",oe,[t.forceAppUpdate?null:s("button",{classMap:E,key:8,on:{click:m||(o._m0=c(t.remindMeLater))}},[s("label",ie,[r(a(t.labels.RemindMeLater))])]),s("button",{classMap:E,key:10,on:{click:U||(o._m1=c(t.openStore))}},[s("label",ae,[r(a(t.labels.UpdateNow))])])])])]),u(z(),13)]):null]}var re=d.registerTemplate(w);w.stylesheets=[],w.stylesheetToken="mobileruntime-appUpdateModal_appUpdateModal",d.freezeTemplate(w);const se={ModalHeader:"Update Your App",ForceUpdateModalBody:"You must update to the latest version of this app to continue using it.",ModalBody:"A new version of this app is available.Find and install the latest version of the app for your device.",RemindMeLater:"Remind Me Later",UpdateNow:"Update Now"};class D extends d.LightningElement{constructor(...t){super(...t);this.showModal=!0,this.config={}}get labels(){return se}get modalBody(){return this.config.forceAppUpdate?this.labels.ForceUpdateModalBody:this.labels.ModalBody}openStore(){window.open(this.config?.minVersion?.url?.trim())}remindMeLater(){this.showModal=!1}}d.registerDecorators(D,{publicProps:{config:{config:0}},fields:["showModal"]});var le=d.registerComponent(D,{tmpl:re,sel:"mobileruntime-appUpdateModal"});const ce=["payload"];function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(o){de(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function de(e,t,n){return t=ue(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e){var t=fe(e,"string");return typeof t=="symbol"?t:String(t)}function fe(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pe(e,t){if(e==null)return{};var n=he(e,t),o,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)o=a[i],!(t.indexOf(o)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,o)||(n[o]=e[o]))}return n}function he(e,t){if(e==null)return{};var n={},o=Object.keys(e),i,a;for(a=0;a<o.length;a++)i=o[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}const me=`/services/data/v57.0/connect/sites/${G.default}/cms/delivery/contents?contentTypeFQN=sfdc_cms__mobilePublisherConfig&includeContentBody=true`;function P(e,t){if(!b()){l.log("Native JS API is not available");return}const{invokeNative:n}=window.mycommunities.nativejsapi;return n(e,t)}function ge(e=""){return new RegExp("^([a-z]+://)","i").test(e)}function we(e=""){if(!ge(e))return!1;const t=new URL(e),n=window.location.host;return t.host!==n}async function ve(){if(!b()){l.log("Native JS API is not available");return}K();try{const e=await B.fetch(me,{method:"GET"});if(e.status===200){const t=await e.json(),n=window.location.href.endsWith("/")?window.location.href.slice(0,-1):window.location.href,{nativeTabMenu:o,mobilePublisherAppUpdateConfig:i}=t.contents[0]?.contentBody||{};if(o?.menuItems?.forEach((a,r)=>{const{payload:s}=a,c=pe(a,ce);o.menuItems[r]=v(v({},c),{},{id:(r+1)*10,position:r+1,targetUrl:n+a.targetUrl,iconDetails:v(v({},c.iconDetails),{},{mimeType:"image/png",url:`data:image/png;base64,${s}`})})}),i){const{forceAppUpdate:a,enableAppUpdate:r,minVersion:s}=i,c=Me()?"ios":Ee()?"android":"",u={forceAppUpdate:a,enableAppUpdate:r,minVersion:s[c]};Oe("forceAppUpdate")?o.appUpdateConfig={enableAppUpdate:r,gracePeriod:a?0:15}:Ue(u)}L(o)}else l.log("Failed to fetch bottom tab bar. Status is: ",e.status),L(!0)}catch(e){l.log("Failed to fetch bottom tab bar",e),L(!0)}l.log("Initial load done! Splash Screen hidden")}function be(e,t){const n=new URL(e||"",window.location.origin);e=n.href;const o="/servlet/networks/switch",i=n.pathname,a=i.indexOf("/s/"),r=a===-1?i:i.substring(0,a+2);return[o,encodeURIComponent(o)].some(s=>e.includes(s))||!r.startsWith(t)}function ye(e){if(!e)return null;switch(e.length){case 15:return Ce(e);case 18:return e;default:return null}}function Pe(){const{cordova:e}=window;return typeof e!="undefined"&&e&&e.require("cordova/channel")&&e.require("cordova/channel").onDeviceReady&&e.require("cordova/channel").onDeviceReady.state===2}function A(){return Pe()?window.cordova.require("com.salesforce.plugin.oauth"):null}function Ae(e){if(!e)return!1;const t="/secur/logout.jsp";return e.includes(t)||e.includes(encodeURIComponent(t))}function Le(e){const t=A();t&&t.logout(e)}function T(){l.log("hybrid_app_manager_utils:handle_page_loaded"),Y(),b()&&(typeof window.mycommunities.nativejsapi.webAppPageLoadDone=="function"?(l.log("hybrid_app_manager_utils:handle_page_loaded: webAppPageLoadDone function called"),window.mycommunities.nativejsapi.webAppPageLoadDone()):l.log("hybrid_app_manager_utils:handle_page_loaded:webAppPageLoadDone function is not available"))}function L(e){const{webAppBootstrapDone:t}=window.mycommunities.nativejsapi;l.log("Triggering webAppBootstrapDone"),t(e)}function Oe(e){return b()?window.mycommunities.nativejsapi.clientFeatures?.[e]?.enabled:!1}function Ue(e){const t=De();if(e.enableAppUpdate&&t){const n=e.minVersion.version;if(Re(t,n)){const i=d.createElement("app-update-modal",{is:le});i.config=e,document.body.appendChild(i)}}}function Re(e,t){let n=e.split("."),o=t.split("."),i=0;for(;n.length<o.length;)n.push("0");for(;o.length<n.length;)o.push("0");n=n.map(Number),o=o.map(Number);for(let a=0;a<n.length;++a)if(n[a]!==o[a])if(n[a]>o[a]){i=1;break}else{i=-1;break}return i===-1}function Me(){const e=window.navigator.userAgent;return e.toLowerCase().includes("iphone")||e.toLowerCase().includes("ipad")}function Ee(){return window.navigator.userAgent.toLowerCase().includes("android")}function De(){const t=window.navigator.userAgent.split("CommunityHybridContainer/")[1];return t&&(t.match(/(\d{1,3}\.)?(\d{1,3}\.)?(\d{1,3})/)||[])[0]}function Ce(e){let t="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456";for(let o=0;o<3;++o){let i=0;for(let a=0;a<5;a++){const r=e.charAt(o*5+a);r>="A"&&r<="Z"&&(i+=1<<a)}t+=n.charAt(i)}return e+t}function b(){return window?.mycommunities?.nativejsapi}const Te="/secur/frontdoor.jsp";function ke({routeUrl:e}){const t=A();t?t.authenticate(function(n){n&&n.accessToken&&(document.cookie=`sid=${n.accessToken}; path=/; secure=true`,e!=null&&window.open(e))},function(){l.logError("Error in handler Session Timeout. Cordova OAuth Plugin authentication failed.")}):l.logError("Error in handler Session Timeout. OAuth Plugin is not available.")}async function Ne(){let e=!1;const t=await p.load("@app/user/v/1");try{await p.load(`@app/user?c=${crypto.randomUUID()}`,"mobileruntime/hybridAppManager/v/1")}catch(n){e=!t.isGuest}return e}function k(e){const t=new URL(y.default,window.location.href),n=new URL(e,window.location.href);return y.default&&t.pathname===n.pathname&&t.origin===n.origin}function N(e){const t=A();t?t.authenticate(function(n){window.location.href=`${n.loginUrl}${Te}?sid=${n.accessToken}&retURL=${encodeURIComponent(e||J.default)}&display=touch`},function(){throw new Error("Authentication via Cordova OAuth Plugin failed.")}):window.location.href=e||y.default}function Se(e){if(typeof e=="object"){const{attributes:{url:t}={url:null}}=e;if(k(t)){const n=new URL(t,window.location.href);return N(n.searchParams.get("startURL")),!1}}return!0}async function je({next:{route:e,data:t}={}}={}){if(t&&t.isPublic!==!1)return!0;const{default:n}=await p.load("@app/user/v/1");if(n.isGuest){const o=await R.generateUrl(e);if(o){const i=new URL(o,window.location.href);return N(i.pathname+i.search+i.hash),!1}}return!0}const Ie=["/sfc/servlet.shepherd","/servlet/servlet.FileDownload","/servlet/fileField","version/renditionDownload"];function O(){l.log("Handle showing of Toast Message for Error case.")}function Fe(e){const t="/sfc/servlet.:type/:contentType/download/:recordId",n=new RegExp(t.replace(/:[^\s/]+/g,"([\\w-]+)")),o=e.match(n);if(o&&o.length===4)return{recordId:o[3]};const i="/servlet/servlet.:type?file=:recordId",a=new RegExp(i.replace(/:[^\s/?]+/g,"([\\w-]+)").replace(/\?/g,"[?]")),r=e.match(a);if(r&&r.length===3)return{recordId:r[2]};const s="/servlet/fileField";if(e.includes(s)){const u=new URLSearchParams(decodeURIComponent(e).split("?")[1]),m=u.get("entityId"),U=u.get("field");return{recordId:m,fieldId:U}}const c="version/renditionDownload";if(e.includes(c)){const m=new URL(e).searchParams.get("versionId");return{recordId:ye(m)}}return null}function xe(e){const t=P("downloadFile",e);if(t)return t.catch(n=>{l.log(`Error while downloading file of record id: ${e.recordId} message: ${n}`&&n.message),O()})}function Be(e){if(!e){l.log(`${q.default}. URL is ${e}`),O();return}const t=Fe(e);if(!t){l.log(`Parsing the file URL "${e}" yielded null`),O();return}return xe(t)}function Ve(e){return e=e||"",Ie.some(t=>e.indexOf(t)>-1)}const _e=globalThis.open;function S(e){const t=new URL(e,window.location.href);if(e=t.href,e.indexOf("/")!==0&&e.indexOf("http://")!==0&&e.indexOf("https://")!==0)return _e(e,"_self");if(Ae(e))Le(e);else if(we(t))P("navigateToExternalURL",{url:e});else if(k(e))j({type:"standard__webPage",attributes:{url:t.pathname+t.searchParams+t.hash}},!1);else if(Ve(e))Be(e);else if(be(e,M.default))P("navigateToExternalURL",{url:e});else{const n=t.pathname,o=n==="/"||n===M.default;j({type:"standard__webPage",attributes:{url:n}},o)}}function j(e,t){return document.dispatchEvent(new CustomEvent("notify-client-module",{cancelable:!0,composed:!0,detail:{action:"navigate",data:{routeObj:e,replaceState:t}}}))}function We(){He()}function He(){document.addEventListener("click",Je),document.addEventListener("notify-mobile-module",qe)}function Ge({pathMatch:e,route:t,routeDefinition:n}){const{id:o}=t||{},{type:i}=t?.pageReference||{},{isRoot:a}=n?.metadata||{};document.dispatchEvent(new CustomEvent("routeChangeSuccess",{bubbles:!0,composed:!0,detail:{routeType:i,routeId:o,routeUrl:e,backNavigation:{canGoBack:!a}}}))}function Je(e){const t=e.composedPath()[0];if(t.tagName.toLowerCase()==="a")return e.preventDefault(),e.stopPropagation(),S(t.href)}function qe({detail:e}){const{action:t,data:n}=e||{action:"",data:null};switch(t){case"navigationcompleted":Ge(n?.routeResult||{});break;default:l.log(`No such ${t} exists in notify-mobile-module event. Please re-check!!`);break}}function Ke(){window.open=e=>S(e)}async function I(){return await ve(),/interactive|complete/.test(document.readyState)?T():document.addEventListener("DOMContentLoaded",T,!1),Ke(),We()}function F(){return ke({routeUrl:window.location.pathname}),!1}g.PreNavigateOverrides.add(e=>je(e)),g.NavigationOverrides.add(e=>Se(e)),g.PageNavigationFailureOverrides.add(async({error:e,isPublic:t})=>{const n=await Ne();return e?.constructor?.name==="LoaderError"&&!t&&n?F():!0}),g.SessionTimeoutOverrides.add(()=>F());function Ye(e){Object.entries(e).forEach(([t,n])=>{LWR.define(t,[],function(){return n})})}Ye({"mobileruntime/hybridAppManager":I}),f.hybridAppManager=I,Object.defineProperty(f,"__esModule",{value:!0})});
